<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2012 (1.2)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Scatter and Gather</TITLE>
<META NAME="description" CONTENT="Scatter and Gather">
<META NAME="keywords" CONTENT="chapter_d_C">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2012">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="chapter_d_C.css">

<LINK REL="next" HREF="node14.html">
<LINK REL="previous" HREF="node12.html">
<LINK REL="up" HREF="node10.html">
<LINK REL="next" HREF="node14.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html191"
  HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html189"
  HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html183"
  HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html192"
  HREF="node14.html">Exercises</A>
<B> Up:</B> <A NAME="tex2html190"
  HREF="node10.html">Collective Communications</A>
<B> Previous:</B> <A NAME="tex2html184"
  HREF="node12.html">All to one</A>
<BR>
<BR>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION00133000000000000000"></A>
<A NAME="subsection:scattergather"></A>
<BR>
Scatter and Gather
</H2>
We have looked at collective communications that take the same data and 
communicate it to all processors, and those that reduce data from all processes
to one.  But these communication functions will not allow us send different 
information to each process.  Nor will they allow us to collect separate bits
of information from all of the processes onto one.  For these tasks we can
use MPI_Scatter and MPI_Gather.  

<P>
<PRE>
int MPI\_Scatter (
               void *sendbuf,
               int sendcnt,
               MPI_Datatype sendtype,
               void *recvbuf,
               int recvcnt,
               MPI_Datatype recvtype,
               int root,
               MPI_Comm comm )

int MPI_Gather ( 
               void *sendbuf, 
               int sendcnt, 
               MPI_Datatype sendtype,
               void *recvbuf, int recvcount, 
               MPI_Datatype recvtype,
               int root, 
               MPI_Comm comm )
</PRE>

<P>
The meanings of these parameters are similar to previous commands that we have
studied.  The sendcnt is usually the same as the recvcnt, and the sendtype
is usually the same as the recvtype. We can look at the follow example to see
how MPI_Scatter works.  

<P>
<PRE>
	
main(int argc, char * argv[]){
     int i,vec[4]={0,0,0,0};
     // Initialize MPI 
     MPI_Init(&amp;argc,&amp;argv);
     MPI_Comm_size(MPI_COMM_WORLD,&amp;numOfProcessors);  
     MPI_Comm_rank(MPI_COMM_WORLD,&amp;localRank);
     if(localRank==0){
         for(i=0;i&lt;4;i++) vec[i]=i*2;
     }
     MPI_Scatter(&amp;vec,1,MPI_INT,&amp;vec,1,MPI_INT,0,
                          MPI_COMM_WORLD);

     MPI_Finalize();
}
</PRE>

<P>
This code will distribute the each of the entries of vector vec to the
processes in MPI_COMM_WORLD.  Figure <A HREF="#fig:scat">5.2</A> shows the effects 
of the MPI_Scatter command on the memory for each process. Note that the
blank memory locations are really set to a value of 0.

<DIV ALIGN="CENTER"><A NAME="fig:scat"></A><A NAME="108"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5.2:</STRONG>
The effects of MPI_Scatter</CAPTION>
<TR><TD></TD></TR>
</TABLE>
</DIV>

<P>
MPI_Gather is in some sense the inverse operation to MPI_Scatter.  Instead 
of distributing values, it gathers them together.  The following code and
Figure <A HREF="#fig:gather">5.3</A> show the effects of the MPI_Gather operation.

<P>
<PRE>
main(int argc, char * argv[]){
   int i,vec[4]={0,0,0,0};
	// Initialize MPI 
	MPI_Init(&amp;argc,&amp;argv);
	MPI_Comm_size(MPI_COMM_WORLD,&amp;numOfProcessors);  
	MPI_Comm_rank(MPI_COMM_WORLD,&amp;localRank);
	if(localRank!=0){
	   vec[0]=localRank*2;	
	}
    MPI_Gather(&amp;vec,1,MPI_INT,&amp;vec,1,MPI_INT,0,
								 MPI_COMM_WORLD);

	MPI_Finalize();
</PRE>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:gather"></A><A NAME="116"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5.3:</STRONG>
The effects of MPI_Gather</CAPTION>
<TR><TD></TD></TR>
</TABLE>
</DIV>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html191"
  HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/share/latex2html/icons/next.png"></A> 
<A NAME="tex2html189"
  HREF="node10.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/share/latex2html/icons/up.png"></A> 
<A NAME="tex2html183"
  HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/share/latex2html/icons/prev.png"></A>   
<BR>
<B> Next:</B> <A NAME="tex2html192"
  HREF="node14.html">Exercises</A>
<B> Up:</B> <A NAME="tex2html190"
  HREF="node10.html">Collective Communications</A>
<B> Previous:</B> <A NAME="tex2html184"
  HREF="node12.html">All to one</A>
<!--End of Navigation Panel-->
<ADDRESS>
root
2015-12-02
</ADDRESS>
</BODY>
</HTML>
